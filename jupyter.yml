---
- name: Jupyter and tensorflow and Julia
  hosts: raspberrypis
  become: true
  tasks:
    - name: Update apt
      apt:
        update_cache: yes

    - name: Install Julia
      apt: 
        name: "{{item}}"
      with_items:
        - julia
        - libzmq3-dev
        - python3-zmq
        - "r-base"
        - "r-base-core"
        - "r-base-dev"
        - "libssl-dev"

    - name: Install Jupyter
      pip:
        executable: pip3
        name: jupyter

    - name: Install IJulia
      shell: |
        julia -e 'Pkg.add("IJulia");'

    - name: Copy systemd for jupyter-notebook
      copy:
        src: files/systemd/jupyter.service
        dest: /etc/systemd/system

    - name: create notebooks directory
      file:
        path: /storage/docker/jupyter/notebooks
        mode: 0777
        state: directory

    - name: start and enable jupyter
      systemd:
        name: jupyter
        enabled: yes
        state: started

    - name: Install Ipython for Python 2
      pip:
        name: ipykernel

    - name: Install tensorflow
      shell: pip install https://github.com/samjabrahams/tensorflow-on-raspberry-pi/releases/download/v1.1.0/tensorflow-1.1.0-cp27-none-linux_armv7l.whl


    - name: Install Ipython2 kernel
      shell: ipython kernel install --user

    - name: Install Ipython3 kernel
      shell: ipython3 kernel install --user

    - name: Install bash_jupyter
      pip:
        name: bash_kernel

    - name: Install bash_kernel kernelspec
      shell: python -m bash_kernel.install 












